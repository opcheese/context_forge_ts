import{b as g,d as p,r as i,j as e,i as f,k as C}from"./index-C_UHGseK.js";import{a as m}from"./api-B6BZvDqw.js";import{B as l}from"./button-nz7UIBa1.js";function D(t){const r=Math.floor((Date.now()-t)/1e3);return r<60?"just now":r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:`${Math.floor(r/86400)}d ago`}function P({isOpen:t,onClose:r}){const[n,o]=i.useState(""),[d,a]=i.useState(""),[c,u]=i.useState(""),[x,j]=i.useState(!1),b=p(m.projects.create),v=p(m.workflows.startProject),w=g(m.workflows.list),N=C(),k=async s=>{s.preventDefault(),j(!0);try{if(c){const y=await v({workflowId:c,projectName:n.trim(),projectDescription:d.trim()||void 0});o(""),a(""),u(""),r(),N({to:"/app/projects/$projectId",params:{projectId:y.projectId}})}else await b({name:n.trim(),description:d.trim()||void 0}),o(""),a(""),u(""),r()}finally{j(!1)}};if(!t)return null;const h=w?.filter(s=>s.steps.length>0)??[];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Create New Project"}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-name",className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{id:"project-name",type:"text",value:n,onChange:s=>o(s.target.value),placeholder:"My Game Design Project",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-description",className:"block text-sm font-medium mb-1",children:"Description (optional)"}),e.jsx("textarea",{id:"project-description",value:d,onChange:s=>a(s.target.value),placeholder:"Brief description of the project...",rows:3,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm resize-none"})]}),h.length>0&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-workflow",className:"block text-sm font-medium mb-1",children:"Workflow (optional)"}),e.jsxs("select",{id:"project-workflow",value:c,onChange:s=>u(s.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"No workflow â€” blank project"}),h.map(s=>e.jsxs("option",{value:s._id,children:[s.name," (",s.steps.length," step",s.steps.length!==1?"s":"",")"]},s._id))]}),c&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Project will start at step 1 of the selected workflow."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),e.jsx(l,{type:"submit",disabled:!n.trim()||x,children:x?"Creating...":c?"Start Workflow":"Create Project"})]})]})]})})}function S({project:t,onDelete:r}){const[n,o]=i.useState(!1);return e.jsxs("div",{className:"rounded-lg border border-border bg-card p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(f,{to:"/app/projects/$projectId",params:{projectId:t._id},className:"font-semibold text-lg truncate hover:underline",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:t.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground whitespace-nowrap",children:D(t.updatedAt)})]}),e.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-xs px-2 py-1 rounded-md bg-muted",children:[t.sessionCount," session",t.sessionCount!==1?"s":""]}),t.currentStep!==void 0&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-md bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:["Step ",t.currentStep]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-border flex gap-2",children:[e.jsx(f,{to:"/app/projects/$projectId",params:{projectId:t._id},children:e.jsx(l,{variant:"outline",size:"sm",children:"Open"})}),n?e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"destructive",size:"sm",onClick:r,children:"Confirm Delete"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>o(!1),children:"Cancel"})]}):e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>o(!0),className:"text-destructive hover:text-destructive",children:"Delete"})]})]})}function M(){const t=g(m.projects.list),r=p(m.projects.remove),[n,o]=i.useState(!1),d=async a=>{await r({id:a})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Projects"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Organize related sessions into projects"})]}),e.jsx(l,{onClick:()=>o(!0),children:"+ New Project"})]}),t===void 0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Loading projects..."}):t.length===0?e.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create a project to organize your sessions and track workflow progress."}),e.jsx(l,{onClick:()=>o(!0),children:"Create Your First Project"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.map(a=>e.jsx(S,{project:a,onDelete:()=>d(a._id)},a._id))}),e.jsx(P,{isOpen:n,onClose:()=>o(!1)})]})}export{M as component};
