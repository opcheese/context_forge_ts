import{r as s,u as v,d as C,b as h,j as p}from"./index-C_UHGseK.js";import{a as f}from"./api-B6BZvDqw.js";const t="contextforge-session-id",d=s.createContext(null);function j({children:i}){const[a,o]=s.useState(null),[m,c]=s.useState(!0),{isAuthenticated:r}=v(),l=s.useRef(r),S=C(f.sessions.create),u=h(f.sessions.list);s.useEffect(()=>{l.current&&!r&&(localStorage.removeItem(t),o(null),c(!0)),l.current=r},[r]),s.useEffect(()=>{(async()=>{const e=localStorage.getItem(t);if(e&&u?.some(E=>E._id===e)){o(e),c(!1);return}u!==void 0&&c(!1)})()},[u]),s.useEffect(()=>{a&&localStorage.setItem(t,a)},[a]);const x=s.useCallback(async n=>{const e=await S({name:n});return localStorage.setItem(t,e),o(e),e},[S]),I=s.useCallback(n=>{localStorage.setItem(t,n),o(n)},[]),g=s.useCallback(()=>{localStorage.removeItem(t),o(null)},[]);return p.jsx(d.Provider,{value:{sessionId:a,isLoading:m,createSession:x,switchSession:I,clearSession:g},children:i})}function k(){const i=s.useContext(d);if(!i)throw new Error("useSession must be used within a SessionProvider");return i}export{j as S,k as u};
